!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("phylocanvas"));else if("function"==typeof define&&define.amd)define(["phylocanvas"],e);else{var i=e("object"==typeof exports?require("phylocanvas"):t.phylocanvas);for(var o in i)("object"==typeof exports?exports:t)[o]=i[o]}}(this,function(t){return function(t){function e(o){if(i[o])return i[o].exports;var s=i[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){t(this,"createTree",function(t,e){var i=t.apply(void 0,o(e)),s=n(e,2),r=s[1],a=void 0===r?{}:r;return i.measureTool=new f(i,a.measureTool),i}),t(l.Tree,"draw",function(t,e){t.apply(this,e),this.measureTool.draw.apply(this.measureTool,e)}),this.MeasureTool=f}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){var i=[],o=!0,s=!1,r=void 0;try{for(var n,a=t[Symbol.iterator]();!(o=(n=a.next()).done)&&(i.push(n.value),!e||i.length!==e);o=!0);}catch(l){s=!0,r=l}finally{try{!o&&a["return"]&&a["return"]()}finally{if(s)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=r;var l=i(1),h=l.utils.canvas,c=h.getPixelRatio,u=h.translatePoint,y={fillStyle:"black",strokeStyle:"blue",lineWidth:2,fontSize:18,fontFamily:"Sans-serif",textBaseline:"middle",textAlign:"center",crosshairSize:10,guidelines:!0},f=function(){function t(e){var i=this,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];s(this,t),this.tree=e,this.canvas=e.canvas.canvas,this.cxt=e.canvas,this.pixelRatio=c(this.cxt),Object.assign(this,y,o),this.isActive=!1,this.tree.addListener("click",function(t){return i.onClick(t)}),this.tree.addListener("mousemove",function(t){return i.onMousemove(t)}),this.tree.addListener("keydown",function(t){return i.onKeydown(t)})}return a(t,[{key:"enable",value:function(){this.isActive||(this.isActive=!0,this.originalCursor=this.canvas.style.cursor,this.canvas.style.cursor="crosshair",this.tree.draw())}},{key:"disable",value:function(){this.isActive&&(this.isActive=!1,this.canvas.style.cursor=this.originalCursor,this.tree.draw())}},{key:"toggle",value:function(){this.isActive?this.disable():this.enable()}},{key:"onClick",value:function(t){this.isActive&&(t.preventDefault(),t.stopImmediatePropagation(),this.clickPoint?this.clickPoint=null:this.clickPoint=u({x:t.layerX,y:t.layerY},this.tree),this.tree.draw())}},{key:"onMousemove",value:function(t){this.isActive&&(this.mousePoint=u({x:t.layerX,y:t.layerY},this.tree),this.xAxisOnly=!this.yAxisOnly&&t.metaKey||t.ctrlKey,this.yAxisOnly=!this.xAxisOnly&&t.shiftKey)}},{key:"onKeydown",value:function(t){this.isActive&&(27===t.which&&(this.clickPoint=null,this.mousePoint=null),this.tree.draw())}},{key:"draw",value:function(){if(this.isActive){var t=this.tree,e=this.canvas,i=this.cxt,o=this.pixelRatio,s=this.fontSize,r=this.crosshairSize,n=this.guidelines,a=this.xAxisOnly,l=this.yAxisOnly,h=this.clickPoint,c=this.mousePoint;if(n&&c){var u=(0-t.offsety*o)/t.zoom,y=(e.height-t.offsety*o)/t.zoom,f=(0-t.offsetx*o)/t.zoom,x=(e.width-t.offsetx*o)/t.zoom;i.beginPath(),l||(i.moveTo(c.x,u),i.lineTo(c.x,y),i.stroke()),a||(i.moveTo(f,c.y),i.lineTo(x,c.y),i.stroke()),i.closePath()}if(h&&(i.fillStyle=this.fillStyle,i.strokeStyle=this.strokeStyle,i.lineWidth=Math.max(.01,this.lineWidth/t.zoom),i.textBaseline=this.textBaseline,i.textAlign=this.textAlign,i.font=s/t.zoom+"px "+this.fontFamily,this.drawCrosshair(h,r),c)){var v=h,d={x:l?h.x:c.x,y:a?h.y:c.y};i.beginPath(),i.moveTo(v.x,v.y),i.lineTo(d.x,d.y),i.stroke(),i.closePath();var m=Math.hypot(v.x-d.x,v.y-d.y),p=(m/t.branchScalar).toFixed(6),k=i.measureText(p).width,b=s/t.zoom,A={x:(v.x+d.x)/2,y:(v.y+d.y)/2};i.clearRect(A.x-k/2,A.y-b/2,k,b),i.fillText(p,A.x,A.y),(a||l)&&this.drawCrosshair(d,r)}}}},{key:"drawCrosshair",value:function(t,e){var i=this.tree,o=this.pixelRatio,s={x:t.x-e/i.zoom*o,y:t.y-e/i.zoom*o},r={x:t.x+e/i.zoom*o,y:t.y+e/i.zoom*o};this.cxt.beginPath(),this.cxt.moveTo(t.x,s.y),this.cxt.lineTo(t.x,r.y),this.cxt.moveTo(s.x,t.y),this.cxt.lineTo(r.x,t.y),this.cxt.stroke(),this.cxt.closePath()}}]),t}()},function(e,i){e.exports=t}])});